/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){if(typeof define=="function"&&define.amd)define(t);else{var n=t();e.ResizeController=n.ResizeController,e.ResponsiveImage=n.ResponsiveImage,e.ScrollController=n.ScrollController,e.morlock=n.morlock}})(this,function(){var e,t,n;return function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../vendor/almond",function(){}),n("morlock/core/util",["exports"],function(e){function t(e,t){return Array.prototype.slice.call(e,t)}function n(e){return t(e,0)}function r(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function i(e,t){var n,r=0;return function(){var i=arguments,s=+(new Date),o=t-(s-r);o<=0?(clearTimeout(n),n=null,r=s,_(e,i)):n||(n=setTimeout(function(){r=+(new Date),n=null,_(e,i)},o))}}function s(e,t){var n=null;return function(){clearTimeout(n);var r=arguments;n=setTimeout(function(){n=null,e.apply(null,r)},t)}}function o(e,t,n){var r=document.documentElement;return f("(min-"+e+":"+window[t]+"px)")?function(){return window[t]}:function(){return r[n]}}function f(e){var t=window.matchMedia||window.msMatchMedia;if(t)return!!t(e).matches;var n=document.createElement("div");return n.id="testmq",n.innerHTML='<style id="stestmq">@media '+e+" { #testmq { position: absolute; } }</style>",document.body.appendChild(n),(window.getComputedStyle?getComputedStyle(n,null):n.currentStyle)["position"]=="absolute"}function l(e,t,n){t=typeof t=="number"&&t||0,e&&!e.nodeType&&(e=e[0]);if(!e||1!==e.nodeType)return!1;var r=e.getBoundingClientRect();"undefined"==typeof n&&(n=window.scrollY);var i=n<0?r.top+n:r.top,s={right:r.right+t,left:r.left-t,bottom:r.bottom+t,top:i-t};return s.width=s.right-s.left,s.height=s.bottom-s.top,s}function c(e,t){return S(function(n,r){return n[r]=e(t[r],r),n},p(t),{})}function h(e,t){return S(function(t,n){return U(t,e(n))},t,[])}function p(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function d(e,t){return e[t]}function v(e,t,n){e[t]=n}function m(e){return function(){return _(e,Array.prototype.reverse.call(arguments))}}function g(e){return!e||!e.length}function y(e){return h(A(d,e),p(e))}function b(e){this.fn=e}function w(e){var t=function(){var t=e.apply(this,arguments);while(t instanceof b)t=t.exec();return t};return t.original_fn=e,t}function E(e){var t=this,n=D(arguments);return e.original_fn instanceof Function?new b(function(){return e.original_fn.apply(t,n)}):new b(function(){return e.apply(t,n)})}function S(e,t,n){var r=w(function i(t,n){return g(n)?t:E(i,e(t,j(n)),D(n))});return r(n,t)}function x(e,t){return S(function(t,n){return I(e(n))?U(t,n):t},t,[])}function T(e,t){return S(function(t,n){return I(e(n))?t:U(t,n)},t,[])}function N(e){return!e}function C(e,t){return e===t}function k(e,t){return function(){var n=e;"function"==typeof e&&(n=_(e,arguments));if(n)return _(t,arguments)}}function L(e,t){return Function.prototype.bind?e.bind(t):function(){return e.apply(t,arguments)}}function A(e){var n=D(arguments);return function(){var r=t(arguments,0);return e.apply(this,n.concat(r))}}function O(e,t){return function(){setTimeout(A(e,arguments),t)}}function M(e,t){return O(e,"undefined"!=typeof t?1:t)}function _(e,t){return e.apply(null,t)}function D(e,n){return n="undefined"!=typeof n?n:1,t(e,n)}function P(e){return _(e,D(arguments))}function H(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)};if(e.attachEvent)return e.attachEvent("on"+t,n),function(){e.detachEvent("on"+t,n)}}function B(e,t){return t[e]}function j(e){return e[0]}function F(e){return e[e.length-1]}function q(e,t){var r=n(e);return Array.prototype.unshift.call(r,t),r}function R(e,t){var r=n(e);return Array.prototype.shift.call(r,t),r}function U(e,t){var r=n(e);return Array.prototype.push.call(r,t),r}function z(e,t){var r=n(e);return Array.prototype.pop.call(r,t),r}function W(e,t){var r=n(e);return Array.prototype.sort.call(r,t),r}function X(){var e=arguments;return function(t){for(var n=e.length-1;n>=0;--n)t=e[n](t);return t}}function V(e){var t=D(arguments),n=!1;return function(){if(!n)return n=!0,_(e,t)}}function $(e){return parseInt(e,10)}function J(e){return e}var u=o("width","innerWidth","clientWidth"),a=o("height","innerHeight","clientHeight");b.prototype.exec=function(){return this.fn()};var I=A(C,!0),K=function(){var e=window.requestAnimationFrame,t=0,n=["webkit","moz"];for(var r=0;r<n.length&&!e;++r)e=window[n[r]+"RequestAnimationFrame"];return e||(e=function(e,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-t)),s=window.setTimeout(function(){e(r+i)},i);return t=r+i,s}),e}();e.indexOf=r,e.throttle=i,e.debounce=s,e.getViewportHeight=a,e.getViewportWidth=u,e.testMQ=f,e.getRect=l,e.mapObject=c,e.objectKeys=p,e.functionBind=L,e.partial=A,e.map=h,e.apply=_,e.objectVals=y,e.call=P,e.push=U,e.pop=z,e.unshift=q,e.equals=C,e.not=N,e.delay=O,e.unshift=q,e.nth=B,e.first=j,e.last=F,e.compose=X,e.select=x,e.isTrue=I,e.get=d,e.shift=R,e.eventListener=H,e.when=k,e.reduce=S,e.once=V,e.sortBy=W,e.parseInteger=$,e.set=v,e.flip=m,e.trampoline=w,e.tailCall=E,e.copyArray=n,e.defer=M,e.slice=t,e.isEmpty=g,e.reject=T,e.rest=D,e.constantly=J,e.rAF=K}),n("morlock/core/stream",["morlock/core/util","exports"],function(e,t){function S(e){if(!(this instanceof S))return new S(e);this.trackSubscribers=!!e,this.subscribers=null,this.subscriberSubscribers=null,this.streamID=E++,this.value=null}function x(e){return new S(e)}function T(e,t){s(d(g(y),t),e.subscribers),e.value=t}function N(e){return e.value}function C(e,t){e.subscribers=e.subscribers||[],e.subscribers.push(t),e.trackSubscribers&&s(d(g(y),t),e.subscriberSubscribers)}function k(e,t){if(e.subscribers){var n=b(e.subscribers,t);n!==-1&&e.subscribers.splice(n,1)}}function L(e,t){e.trackSubscribers&&(e.subscriberSubscribers=e.subscriberSubscribers||[],e.subscriberSubscribers.push(t))}function A(e,t){var n=x(!0),r=d(T,n),i=d(c,e,t,r);return L(n,v(i)),n}function O(e){var t=x(!0),n=d(T,t),r=d(setInterval,n,e);return L(t,v(r)),t}function M(e){var t=x(!0),n=d(T,t),r=d(setTimeout,n,e);return L(t,v(r)),t}function _(){function n(e){t(e),w(n)}var e=x(!0),t=d(T,e);return L(e,v(n)),e}function D(){var e=m(arguments),t=x(),n=d(T,t);return s(function(e){return C(e,n)},e),t}function P(e,t,n){var r=x(),i=d(T,r),u=s(function(e){return e===":e:"?i:e},n);return C(e,o(o,[t,u])),r}function H(e,t){return e<=0?t:P(t,i,[":e:",e])}function B(e,t){return e<=0?t:P(t,r,[":e:",e])}function j(e,t){return e<=0?t:P(t,n,[":e:",e])}function F(e,t){return P(t,h,[":e:",e])}function I(e,t){return P(t,p,[e,":e:"])}function q(e,t){return P(t,h,[":e:",d(N,e)])}var n=e.debounce,r=e.throttle,i=e.delay,s=e.map,o=e.apply,u=e.first,a=e.rest,f=e.push,o=e.apply,l=e.unshift,c=e.eventListener,h=e.compose,p=e.when,d=e.partial,v=e.once,m=e.copyArray,g=e.flip,y=e.call,b=e.indexOf,w=e.rAF,E=0;t.create=x,t.emit=T,t.getValue=N,t.onValue=C,t.offValue=k,t.onSubscription=L,t.createFromEvents=A,t.timeout=M,t.createFromRAF=_,t.merge=D,t.delay=H,t.throttle=B,t.debounce=j,t.map=F,t.filter=I,t.sample=q,t.interval=O}),n("morlock/streams/breakpoint-stream",["morlock/core/util","morlock/core/stream","exports"],function(e,t,n){function l(e,t){var n=s(function(e,n){var r=f.create(),s="string"==typeof e?e:c(e);return f.onValue(t,function(){var e=f.getValue(r);e=e!==null?e:!1,e!==a(s)&&f.emit(r,!e)}),f.map(i(u,[n]),r)},e);return o(f.merge,r(n))}function c(e){var t;return"undefined"!=typeof e.mq?t=e.mq:(e.max="undefined"!=typeof e.max?e.max:Infinity,e.min="undefined"!=typeof e.min?e.min:0,t="only screen",e.max<Infinity&&(t+=" and (max-width: "+e.max+"px)"),e.min>0&&(t+=" and (min-width: "+e.min+"px)")),t}var r=e.objectVals,i=e.partial,s=e.mapObject,o=e.apply,u=e.push,a=e.testMQ,f=t;n.create=l}),n("morlock/streams/resize-stream",["morlock/core/stream","exports"],function(e,t){function r(e){e=e||{};var t="undefined"!=typeof e.throttleMs?e.throttleMs:200,r="undefined"!=typeof e.orientationChangeDelayMs?e.orientationChangeDelayMs:100,i="undefined"!=typeof e.resizeStream?e.resizeStream:n.createFromEvents(window,"resize"),s=n.merge(n.throttle(t,i),n.delay(r,n.createFromEvents(window,"orientationchange")));return setTimeout(function(){window.dispatchEvent(new Event("resize"))},10),s}var n=e;t.create=r}),n("morlock/controllers/resize-controller",["morlock/core/util","morlock/core/stream","morlock/streams/breakpoint-stream","morlock/streams/resize-stream","exports"],function(e,t,n,r,i){function y(e){if(!(this instanceof y))return new y(e);e=e||{};var t=g.create(e),n;"undefined"!=typeof e.breakpoints&&(n=m.create(e.breakpoints,t)),this.on=function(e,r){"resize"===e?v.onValue(v.map(function(){return[window.innerWidth,window.innerHeight]},t),r):"breakpoint"===e&&n&&v.onValue(v.map(function(e){return[a(e),e[1]?"enter":"exit"]},n),r)};var r={};n&&v.onValue(n,function(e){r[e[0]]=e[1]}),this.getActiveBreakpoints=function(){var t=f(l,o(h,r));return c(t,s(r))}}var s=e.objectKeys,o=e.partial,u=e.equals,a=e.first,f=e.compose,l=e.isTrue,c=e.select,h=e.get,p=e.shift,d=e.nth,v=t,m=n,g=r;i["default"]=y}),n("morlock/streams/scroll-stream",["morlock/core/stream","exports"],function(e,t){function r(e){e=e||{};var t="undefined"!=typeof e.debounceMs?e.debounceMs:200,r=n.debounce(t,i());return setTimeout(function(){window.dispatchEvent(new Event("scroll"))},10),r}function i(){var e,t=!0;n.onValue(n.createFromEvents(window,"scroll"),function(){t=!0});var r=n.createFromRAF(),i=n.filter(function(){if(!t)return!1;t=!1;var n=window.scrollY;return e!==n?(e=n,!0):!1},r);return n.map(function(){return e},i)}var n=e;t.create=r}),n("morlock/streams/element-tracker-stream",["morlock/core/util","morlock/core/stream","exports"],function(e,t,n){function o(e,t,n){function f(){u=r(),l()}function l(t){var n=i(e,null,t),r=!!n&&n.bottom>=0&&n.top<=u;a&&!r?(a=!1,s.emit(o,"exit")):!a&&r&&(a=!0,s.emit(o,"enter"))}var o=s.create(),u,a=!1;return s.onValue(t,l),s.onValue(n,f),f(),o}var r=e.getViewportHeight,i=e.getRect,s=t;n.create=o}),n("morlock/streams/scroll-tracker-stream",["morlock/core/util","morlock/core/stream","morlock/streams/scroll-stream","exports"],function(e,t,n,r){function a(e,t){t=t||u.create({debounceMs:0});var n=o.create(),r=!1,i=!0;return o.onValue(t,function(t){(i||r)&&t<e?(r=!1,o.emit(n,["before",e])):(i||!r)&&t>=e&&(r=!0,o.emit(n,["after",e])),i=!1}),setTimeout(function(){window.dispatchEvent(new Event("scroll"))},10),n}var i=e.getViewportHeight,s=e.getRect,o=t,u=n;r.create=a}),n("morlock/controllers/scroll-controller",["morlock/core/util","morlock/core/stream","morlock/streams/scroll-stream","morlock/streams/resize-stream","morlock/streams/element-tracker-stream","morlock/streams/scroll-tracker-stream","exports"],function(e,n,r,i,s,o,u){function g(e){if(!(this instanceof g))return new g(e);var n=p.create(e);this.on=function(e,t){"scrollEnd"===e&&h.onValue(n,t)};var r=d.create();this.observeElement=function(t){var i=v.create(t,n,r);return{on:function(t,n){var r=h.filter(a(f,t),i);return h.onValue(r,n),this}}},this.observePosition=function(r){function c(e,t){var n="both",r;e.length===1?r=e[0]:(n=e[0],r=e[1]);var s;n==="both"?s=i:n==="before"?s=o:n==="after"&&(s=u),t(s,r)}var i=m.create(r,n),s=t("morlock/core/util").first,o=h.filter(l(a(f,"before"),s),i),u=h.filter(l(a(f,"after"),s),i);return{on:function(){return c(arguments,h.onValue),this},off:function(){return c(arguments,h.offValue),this}}}}var a=e.partial,f=e.equals,l=e.compose,c=e.constantly,h=n,p=r,d=i,v=s,m=o;u["default"]=g}),n("morlock/core/responsive-image",["morlock/core/util","exports"],function(e,t){function l(){if(!(this instanceof l))return new l;this.element=null,this.loadedSizes={},this.knownSizes=[],this.currentBreakpoint=null,this.src=null,this.hasWebp=!1,this.isFlexible=!1,this.hasRetina=!1,this.preserveAspectRatio=!1,this.knownDimensions=null}function c(e){var t=new l;return r(a(i(u,t)),e),t.knownDimensions&&t.preserveAspectRatio&&p(t),t}function h(e){var t={};t.element=e,t.src=e.getAttribute("data-src"),t.hasWebp=e.getAttribute("data-hasWebp")==="true",t.isFlexible=e.getAttribute("data-isFlexible")!=="false",t.hasRetina=e.getAttribute("data-hasRetina")==="true"&&window.devicePixelRatio>1.5,t.preserveAspectRatio=e.getAttribute("data-preserveAspectRatio")==="true";var n=e.getAttribute("data-knownDimensions");return n&&n!=="false"&&(t.knownDimensions=[o(n.split("x")[0]),o(n.split("x")[1])]),t.knownSizes=d(t.element),t.knownDimensions&&t.preserveAspectRatio&&p(t),c(t)}function p(e){e.element.style.paddingBottom=e.knownDimensions[1]/e.knownDimensions[0]*100+"%"}function d(e){var t=e.getAttribute("data-breakpoints"),r=n(function(e){return o(e)},t?t.split(","):[]);return r.length<=0?[0]:s(r,function(t,n){return n-t})}function v(e){var t;for(var n=0;n<e.knownSizes.length;n++){var r=e.knownSizes[n],i="only screen and (max-width: "+r+"px)";n===0&&(i="only screen");if(!f(i))break;t=r}t!==e.currentBreakpoint&&(e.currentBreakpoint=t,m(e,e.currentBreakpoint))}function m(e,t){var n=e.loadedSizes[t];if("undefined"!=typeof n)g(e,n);else{var r=new Image;r.onload=function(){e.loadedSizes[t]=r,g(e,r)},r.src=w(e,t)}}function g(e,t){return e.type==="img"?y(e,t):b(e,t)}function y(e,t){e.element.src=t.src}function b(e,t){e.element.style.backgroundImage="url("+t.src+")";if(e.preserveAspectRatio){var n=Modernizr.prefixed("backgroundSize");e.element.style[n]="cover";var r,i;e.knownDimensions?(r=e.knownDimensions[0],i=e.knownDimensions[1]):(r=t.width,i=t.height),e.isFlexible?e.element.style.paddingBottom=i/r*100+"%":(e.element.style.width=r+"px",e.element.style.height=i+"px")}}function w(e,t){if(t===0)return e.src;var n=e.src.split("."),r=n.pop(),i=e.hasWebp&&Modernizr.webp?"webp":r;return n.join(".")+"-"+t+(e.hasRetina?"@2x":"")+"."+i}var n=e.map,r=e.mapObject,i=e.partial,s=e.sortBy,o=e.parseInteger,u=e.set,a=e.flip,f=e.testMQ;t.create=c,t.createFromElement=h,t.update=v}),n("morlock/plugins/jquery.breakpointer",["morlock/controllers/resize-controller"],function(e){var t=e["default"];"undefined"!=typeof $&&($.fn.breakpointer=function(){})}),n("morlock/plugins/jquery.scrolltracker",["morlock/controllers/scroll-controller"],function(e){var t=e["default"];"undefined"!=typeof $&&($.fn.scrolltracker=function(){})}),n("morlock/plugins/jquery.eventstream",["morlock/core/util","morlock/core/stream"],function(e,t){var n=e.map,r=t;"undefined"!=typeof $&&($.fn.eventstream=function(e){var t=this,i=n(function(t){var n=r.create(),i=$(t);return i.on(e,function(e){r.emit(n,e)}),i.data("stream",n),n},t);if(i.length>1)var s=r.merge(i);return t})}),n("morlock/plugins/jquery.morlockResize",["morlock/controllers/resize-controller"],function(e){var t=e["default"];"undefined"!=typeof jQuery&&(jQuery.fn.morlockResize=function(e,n){var r=new t(n);return $(this).each(function(){if(this===window){var t=$(this);t.on("morlockResize",e),r.on("resize",function(e){t.trigger("morlockResize")})}})})}),n("morlock/base",["morlock/controllers/resize-controller","morlock/controllers/scroll-controller","morlock/core/responsive-image","morlock/plugins/jquery.breakpointer","morlock/plugins/jquery.scrolltracker","morlock/plugins/jquery.eventstream","morlock/plugins/jquery.morlockResize","exports"],function(e,t,n,r,i,s,o,u){function p(e){return e="undefined"!=typeof e?e:0,c[e]=c[e]||new f({debounceMs:e}),c[e]}function d(e){return h[e]=h[e]||v.observePosition(e),h[e]}var a=e["default"],f=t["default"],l=n,c={},h={},v={onScrollEnd:function(t){var n=p();return n.on("scrollEnd",t)},observeElement:function(){var t=p();return t.observeElement.apply(t,arguments)},observePosition:function(){var t=p();return t.observePosition.apply(t,arguments)},position:{before:function(e,t){var n=d(e);return n.on("before",t)},after:function(e,t){var n=d(e);return n.on("after",t)}}};u.ResizeController=a,u.ResponsiveImage=l,u.ScrollController=f,u.morlock=v}),t(["morlock/base"]),t("morlock/base")});