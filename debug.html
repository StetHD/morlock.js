<html>
<head>
  <meta charset="utf-8">
  <title>morlock.js Debugger</title>
</head>
<body>
  <div class="js-responsive-image">
  <div style="height: 1000px;"></div>
  <div id="hi" style="height: 500px; background: red;"></div>
  <div style="height: 5000px;"></div>
  <script data-main="dist/morlock-0.0.0.js" src="test/vendor/require.js"></script>
  <script>
    require(['morlock', 'morlock/core/stream', 'morlock/core/util', 'morlock/streams/resize-stream'], function(m, s, u, r) {
      rc = new m.ResizeController({
        breakpoints: {
          'mobile': { max: 767 },
          'tablet': { min: 768, max: 1043 },
          'desktop': { min: 1044 }
        }
      });

      rc.on('resize', function(e) {
        console.log('resize', e[0], e[1]);
      });

      var timeoutStream = s.timeout(1000);
      var resizeStream = r.create({ throttleMs: 0 });
      var dimensionsStream = s.map(function() {
        return [window.innerWidth, window.innerHeight];
      }, resizeStream);

      s.onValue(s.sample(dimensionsStream, timeoutStream), function(v) {
        console.log('Every 1000ms', v);
      });

      // s.onValue(s.createFromRAF(), function(t) {
      //   console.log(t)
      // })

      var responsiveImages = u.map(function(elem) {
        return m.ResponsiveImage.createFromElement(elem);
      }, document.getElementsByClassName('js-responsive-image'));

      rc.on('breakpoint', function(e) {
        console.log('breakpoint', e);

        u.map(m.ResponsiveImage.update, responsiveImages);
      });

      sc = new m.ScrollController({
        debounceMs: 400
      });

      sc.on('scrollEnd', function(e) {
        console.log('scrollEnd');
      });

      var observer = sc.observeElement(document.getElementById('hi'));
      observer.on('enter', function() {
        console.log('enter');
      });
      observer.on('exit', function() {
        console.log('exit');
      });
    });
  </script>
</body>
</html>